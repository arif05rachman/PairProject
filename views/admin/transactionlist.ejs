<%- include('./partials/header') %>
<body>
    <%- include('./partials/navbar', { page: "transaction" }) %>
    <div>
        <div class="text-center mt-4">
            <h2>Transactions List</h2>
        </div>
        <table class="table mt-4 table-hover table-striped text-center table-bordered">
            <thead class="thead-dark">
            <tr>
                <th scope="col">Customer Name</th>
                <th scope="col">Package Name</th>
                <th scope="col">Weight</th>
                <th scope="col">Total Price</th>
                <th scope="col">Date Order</th>
                <th scope="col">Date Est. Complete</th>
                <th scope="col">Date Pickup</th>
                <th scope="col">Date Finish</th>
                <th scope="col">Date Deliver</th>
                <th scope="col">Date Delivered</th>
                <th scope="col">Courier Name</th>
                <th scope="col">Courier Contact</th>
                <th scope="col">Status</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            <% transactions.forEach((transaction, index) => { %>
                <% for (let i = 0; i < list.status.length; i++){ %>
                <tr>
                    <td><%= transaction.name %></td>
                    <td><%= list.packageName[i] %></td> 
                    <td><%= list.weight[i] %> Kgs</td>
                    <td><%= helper.changeNumberFormat(list.priceTotal[i]) %></td>
                    <td><%= list.dateOrder[i] ? helper.dateFormat(list.dateOrder[i]) : '' %></td>
                    <td><%= list.dateEstComplete[i] ? helper.dateFormat(list.dateEstComplete[i]) : ''%></td>
                    <td><%= list.datePickup[i] ? helper.dateFormat(list.datePickup[i]) : '' %></td>
                    <td><%= list.dateFinish[i] ? helper.dateFormat(list.dateFinish[i]) : '' %></td>
                    <td><%= list.dateDeliver[i] ? helper.dateFormat(list.dateDeliver[i]) : '' %></td>
                    <td><%= list.dateDelivered[i] ? helper.dateFormat(list.dateDelivered[i]) : '' %></td>
                    <td><%= list.courierName[i] %></td>
                    <td><%= list.courierContact[i] %></td>
                    <td><%= list.status[i] %></td>
                    <td>
                        <% if(list.status[i] == 'pending'){ %>
                            <a href="/admin/status/<%= transaction.UserPackages[i].UserId %>/<%= transaction.UserPackages[i].PackageId %>"><button type="submit" class="btn btn-warning btn-sm">Pick up</button></a>
                        <% } else if(list.status[i] == 'on progress'){ %>
                            <a href="/admin/status/<%= transaction.UserPackages[i].UserId %>/<%= transaction.UserPackages[i].PackageId %>"><button type="submit" class="btn btn-warning btn-sm">Bag</button></a>
                        <% } else if (list.status[i] == 'closing process'){ %>
                            <a href="/admin/status/<%= transaction.UserPackages[i].UserId %>/<%= transaction.UserPackages[i].PackageId %>"><button type="submit" class="btn btn-warning btn-sm">Deliver</button></a>
                        <% } else if (list.status[i] == 'on delivery'){ %>
                            <a href="/admin/status/<%= transaction.UserPackages[i].UserId %>/<%= transaction.UserPackages[i].PackageId %>"><button type="submit" class="btn btn-warning btn-sm">Delivered</button></a>
                        <% } else if (list.status[i] == 'delivered'){ %>
                            <a href="/admin/status/<%= transaction.UserPackages[i].UserId %>/<%= transaction.UserPackages[i].PackageId %>"><button type="submit" class="btn btn-warning btn-sm">Close Order</button></a>
                        <% } %>
                    </td>
                </tr>
                <% } %>
            <% }) %>
            </tbody>
        </table>
    </div>
</body>

<%- include('./partials/scriptlogin') %>
</html>